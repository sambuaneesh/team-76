<!DOCTYPE html>
<html lang="en-us">
    <button id="theme-toggle" onclick="toggleTheme()">T</button>

    <script type="text/javascript">
        function toggleTheme() {
            const body = document.body;
            if (body.getAttribute('a') === 'dark') {
                body.setAttribute('a', 'light');
            } else {
                body.setAttribute('a', 'dark');
            }
        }
    </script><head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
   <meta name="description" content="main() Function Variable Declarations:
int port_for_client, port_for_nm; char ip[16] = {&#39;\0&#39;}; char paths_file[MAX_FILE_NAME] = {&#39;\0&#39;}; The program starts by declaring variables to store port numbers, IP address, and file paths.
User Input:
printf(&#34;Enter the port number for client: &#34;); scanf(&#34;%d&#34;, &amp;port_for_client); printf(&#34;Enter the port number for NS: &#34;); scanf(&#34;%d&#34;, &amp;port_for_nm); printf(&#34;Enter the IP address of NS: &#34;); scanf(&#34;%s&#34;, ip); printf(&#34;Enter name of paths file: &#34;); scanf(&#34;%s&#34;, paths_file); The program prompts the user for input: client port number, NS port number, NS IP address, and the name of the paths file.">  

  <title>
    
      Storage Server
    
  </title>


  <link rel="shortcut icon" type="image/x-icon" href="/team-76" />
  
  
  
  <link rel="stylesheet" href="/team-76/css/main.6a85a7af1a6b7156001b4b556112280d1e381939d2800ac7ecbad83a93a89ffef6829f8250f61fec6f72de141dc2c58909cd7baeb76a47750be5e0390806839d.css" integrity="sha512-aoWnrxprcVYAG0tVYRIoDR44GTnSgArH7LrYOpOon/72gp&#43;CUPYf7G9y3hQdwsWJCc17rrdqR3UL5eA5CAaDnQ==" />
  
</head>
<body a="dark">
        <main class="page-content" aria-label="Content">
            <div class="w">
<a href="/team-76">$ cd /home</a>


<article>
    <p class="post-meta">
        <time datetime="2023-10-30 22:49:17 &#43;0530 IST">
            
        </time>
    </p>

    <h1>Storage Server</h1>

    

    <h3 id="main-function"><code>main()</code> Function</h3>
<ol>
<li>
<p><strong>Variable Declarations:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> port_for_client, port_for_nm;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">char</span> ip[<span style="color:#ae81ff">16</span>] <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#39;\0&#39;</span>};
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">char</span> paths_file[MAX_FILE_NAME] <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#39;\0&#39;</span>};
</span></span></code></pre></div><p>The program starts by declaring variables to store port numbers, IP address, and file paths.</p>
</li>
<li>
<p><strong>User Input:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;Enter the port number for client: &#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">scanf</span>(<span style="color:#e6db74">&#34;%d&#34;</span>, <span style="color:#f92672">&amp;</span>port_for_client);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;Enter the port number for NS: &#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">scanf</span>(<span style="color:#e6db74">&#34;%d&#34;</span>, <span style="color:#f92672">&amp;</span>port_for_nm);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;Enter the IP address of NS: &#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">scanf</span>(<span style="color:#e6db74">&#34;%s&#34;</span>, ip);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;Enter name of paths file: &#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">scanf</span>(<span style="color:#e6db74">&#34;%s&#34;</span>, paths_file);
</span></span></code></pre></div><p>The program prompts the user for input: client port number, NS port number, NS IP address, and the name of the paths file.</p>
</li>
<li>
<p><strong>Socket Initialization and Connection to Naming Server:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#a6e22e">connect_to_naming_server</span>(ip, <span style="color:#f92672">&amp;</span>naming_server_sock, <span style="color:#f92672">&amp;</span>ss_addr);
</span></span></code></pre></div><p>This function establishes a connection to the naming server using the provided IP address and socket.</p>
</li>
<li>
<p><strong>Command Processing Loop:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">while</span> (<span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span></code></pre></div><p>The program enters an infinite loop to continuously process commands from the naming server.</p>
</li>
<li>
<p><strong>Command Handling:</strong>
The code checks the received command (from the naming server) and performs actions based on the command type.</p>
<ul>
<li>
<p><strong>Command &ldquo;1&rdquo; (Initialization):</strong></p>
<ul>
<li>This command type is not fully implemented in the code snippet you provided. There are commented-out lines indicating file data and port information being sent back to the naming server.</li>
</ul>
</li>
<li>
<p><strong>Command &ldquo;2&rdquo; (Deletion):</strong></p>
<ul>
<li>The program receives a file path and an option (1 for file, 2 for directory) from the naming server.</li>
<li>It attempts to delete the specified file or directory and sends a success or failure message back to the naming server.</li>
</ul>
</li>
<li>
<p><strong>Command &ldquo;3&rdquo; (Creation):</strong></p>
<ul>
<li>The program receives a file path and an option (1 for file, 2 for directory) from the naming server.</li>
<li>It attempts to create the specified file or directory and sends a success or failure message back to the naming server.</li>
</ul>
</li>
<li>
<p><strong>Command &ldquo;5&rdquo; (Writing):</strong></p>
<ul>
<li>The program establishes a connection to a client.</li>
<li>It receives a file path and writes data received from the client to the specified file until a &ldquo;done&rdquo; message is received.</li>
</ul>
</li>
<li>
<p><strong>Command &ldquo;6&rdquo; (Reading):</strong></p>
<ul>
<li>The program establishes a connection to a client.</li>
<li>It receives a file path and reads the content of the specified file, sending it to the client until the entire file is transmitted.</li>
</ul>
</li>
<li>
<p><strong>Command &ldquo;7&rdquo; (Permissions):</strong></p>
<ul>
<li>The program receives a file path and retrieves file information (size and permissions).</li>
<li>It sends the file size and permissions information back to the naming server.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Cleanup and Closing Connections:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#a6e22e">close_socket</span>(<span style="color:#f92672">&amp;</span>naming_server_sock);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">close_socket</span>(<span style="color:#f92672">&amp;</span>sock_ss_client);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">close_socket</span>(<span style="color:#f92672">&amp;</span>client_sock);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span></code></pre></div><p>The program closes the sockets before exiting.</p>
</li>
</ol>
<p>This code represents a basic server implementation that interacts with a naming server to handle various file operations. It uses socket programming to communicate with the naming server and clients, allowing the server to create, delete, read, and write files based on received commands.</p>

</article>

            </div>
        </main>
    </body>
</html>
