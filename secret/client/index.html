<!DOCTYPE html>
<html lang="en-us">
    <button id="theme-toggle" onclick="toggleTheme()">T</button>

    <script type="text/javascript">
        function toggleTheme() {
            const body = document.body;
            if (body.getAttribute('a') === 'dark') {
                body.setAttribute('a', 'light');
            } else {
                body.setAttribute('a', 'dark');
            }
        }
    </script><head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
   <meta name="description" content="Sure, let&rsquo;s go through the client.c code step by step, explaining each part in detail.
int main() { int naming_server_sock; struct sockaddr_in client_addr; socklen_t addr_size; Initialization: The program starts by declaring variables for the naming server socket and client address. connect_to_naming_server(&#34;127.0.0.1&#34;, &amp;naming_server_sock, &amp;client_addr); Connecting to Naming Server: The client establishes a connection with the naming server at the IP address &ldquo;127.0.0.1&rdquo;. int role = 2; if (send(naming_server_sock, &amp;role, sizeof(role), 0) == -1) { perror(RED &#34;[-]Send error&#34; RESET); exit(1); } Role Assignment: The client informs the naming server that it is a client by sending the role (in this case, 2) to the server.">  

  <title>
    
      Client
    
  </title>


  <link rel="shortcut icon" type="image/x-icon" href="/team-76" />
  
  
  
  <link rel="stylesheet" href="/team-76/css/main.6a85a7af1a6b7156001b4b556112280d1e381939d2800ac7ecbad83a93a89ffef6829f8250f61fec6f72de141dc2c58909cd7baeb76a47750be5e0390806839d.css" integrity="sha512-aoWnrxprcVYAG0tVYRIoDR44GTnSgArH7LrYOpOon/72gp&#43;CUPYf7G9y3hQdwsWJCc17rrdqR3UL5eA5CAaDnQ==" />
  
</head>
<body a="dark">
        <main class="page-content" aria-label="Content">
            <div class="w">
<a href="/team-76">$ cd /home</a>


<article>
    <p class="post-meta">
        <time datetime="2023-10-30 22:53:24 &#43;0530 IST">
            
        </time>
    </p>

    <h1>Client</h1>

    

    <p>Sure, let&rsquo;s go through the <code>client.c</code> code step by step, explaining each part in detail.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> naming_server_sock;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">struct</span> sockaddr_in client_addr;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">socklen_t</span> addr_size;
</span></span></code></pre></div><ul>
<li><strong>Initialization</strong>: The program starts by declaring variables for the naming server socket and client address.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#a6e22e">connect_to_naming_server</span>(<span style="color:#e6db74">&#34;127.0.0.1&#34;</span>, <span style="color:#f92672">&amp;</span>naming_server_sock, <span style="color:#f92672">&amp;</span>client_addr);
</span></span></code></pre></div><ul>
<li><strong>Connecting to Naming Server</strong>: The client establishes a connection with the naming server at the IP address &ldquo;127.0.0.1&rdquo;.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> role <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">send</span>(naming_server_sock, <span style="color:#f92672">&amp;</span>role, <span style="color:#66d9ef">sizeof</span>(role), <span style="color:#ae81ff">0</span>) <span style="color:#f92672">==</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">perror</span>(RED <span style="color:#e6db74">&#34;[-]Send error&#34;</span> RESET);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">exit</span>(<span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li><strong>Role Assignment</strong>: The client informs the naming server that it is a client by sending the role (in this case, 2) to the server.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">while</span> (<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> option <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Displaying menu options
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">scanf</span>(<span style="color:#e6db74">&#34;%d&#34;</span>, <span style="color:#f92672">&amp;</span>option);
</span></span></code></pre></div><ul>
<li><strong>Menu Display and Input</strong>: The client displays a menu with different options and waits for the user to input their choice.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (option <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Code for connecting to a storage server (not implemented)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (option <span style="color:#f92672">==</span> <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Code for deleting a file or directory
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (option <span style="color:#f92672">==</span> <span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Code for creating an empty file or directory
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (option <span style="color:#f92672">==</span> <span style="color:#ae81ff">4</span>)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Code for copying files/directories (not implemented)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (option <span style="color:#f92672">==</span> <span style="color:#ae81ff">5</span>)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Code for writing to a file
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (option <span style="color:#f92672">==</span> <span style="color:#ae81ff">6</span>)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Code for reading a file
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (option <span style="color:#f92672">==</span> <span style="color:#ae81ff">7</span>)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Code for getting file information (permissions)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">printf</span>(RED <span style="color:#e6db74">&#34;Invalid option</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span> RESET);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li><strong>Option Handling</strong>: Depending on the user&rsquo;s choice, the client executes different blocks of code corresponding to the selected option.</li>
</ul>
<p><strong>Option 2: Deleting a File/Directory</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">else</span> <span style="color:#a6e22e">if</span> (option <span style="color:#f92672">==</span> <span style="color:#ae81ff">2</span>) <span style="color:#75715e">// Deletion
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>{
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Code for deleting a file or directory
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span></code></pre></div><ul>
<li>The client sends a command &ldquo;2&rdquo; to the naming server to indicate the intention to delete a file or directory.</li>
<li>It takes the user input for the file/directory path and deletion option (file or directory).</li>
<li>Sends the path and deletion option to the naming server.</li>
<li>Receives acknowledgment and success/failure messages from the naming server.</li>
</ul>
<p><strong>Option 3: Creating an Empty File/Directory</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">else</span> <span style="color:#a6e22e">if</span> (option <span style="color:#f92672">==</span> <span style="color:#ae81ff">3</span>) <span style="color:#75715e">// Creation
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>{
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Code for creating an empty file or directory
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span></code></pre></div><ul>
<li>The client sends a command &ldquo;3&rdquo; to the naming server to indicate the intention to create a file or directory.</li>
<li>It takes the user input for the file/directory path and creation option (file or directory).</li>
<li>Sends the path and creation option to the naming server.</li>
<li>Receives acknowledgment and success/failure messages from the naming server.</li>
</ul>
<p><strong>Option 5: Writing to a File</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">else</span> <span style="color:#a6e22e">if</span> (option <span style="color:#f92672">==</span> <span style="color:#ae81ff">5</span>) <span style="color:#75715e">// Write
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>{
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Code for writing to a file
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span></code></pre></div><ul>
<li>The client sends a command &ldquo;5&rdquo; to the naming server to indicate the intention to write to a file.</li>
<li>It takes the user input for the file path.</li>
<li>Sends the path to the naming server.</li>
<li>Receives IP address and port of the storage server from the naming server.</li>
<li>Connects to the storage server.</li>
<li>Allows the user to input data to be written to the file and sends it to the storage server until the user enters &ldquo;done&rdquo;.</li>
</ul>
<p><strong>Option 6: Reading a File</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">else</span> <span style="color:#a6e22e">if</span> (option <span style="color:#f92672">==</span> <span style="color:#ae81ff">6</span>) <span style="color:#75715e">// Read
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>{
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Code for reading a file
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span></code></pre></div><ul>
<li>The client sends a command &ldquo;6&rdquo; to the naming server to indicate the intention to read a file.</li>
<li>It takes the user input for the file path.</li>
<li>Sends the path to the naming server.</li>
<li>Receives IP address and port of the storage server from the naming server.</li>
<li>Connects to the storage server.</li>
<li>Receives file data from the storage server and prints it until the end of the file.</li>
</ul>
<p><strong>Option 7: Getting File Information (Permissions)</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">else</span> <span style="color:#a6e22e">if</span> (option <span style="color:#f92672">==</span> <span style="color:#ae81ff">7</span>) <span style="color:#75715e">// Permissions
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>{
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Code for getting file information (permissions)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span></code></pre></div><ul>
<li>The client sends a command &ldquo;7&rdquo; to the naming server to indicate the intention to get file information.</li>
<li>It takes the user input for the file path.</li>
<li>Sends the path to the naming server.</li>
<li>Receives IP address and port of the storage server from the naming server.</li>
<li>Connects to the storage server.</li>
<li>Receives file information (size and permissions) from the storage server and prints it.</li>
</ul>
<p>This loop continues, allowing the user to perform various actions until they choose to exit the program. Each option corresponds to a specific action involving communication with the naming server and, potentially, a storage server.</p>

</article>

            </div>
        </main>
    </body>
</html>
